---
title: "Case study 2 "
author: "Tran Thanh Hoa"
date: "2025-11-22"
output: 
  html_document: 
    toc: true # Show table of contents
    toc_float: true # Table of contents scrolls along with the page
    theme: flatly #Beautiful interface
    highlight: tango #Command color
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,       # Show code (select FALSE if reporting to the sales manager)
  warning = FALSE,   # Hide technical warnings
  message = FALSE,   # Hide package download notification
  comment = "",      # Remove the ## before the result
  fig.width = 8,     # Default chart width
  fig.height = 5     # Default chart height
)
```

```{css, echo=FALSE}
/* Setting Title  */
h1.title {
  font-size: 38px;      /* Font size */
  color: #2E8B57;       /* color  */
  font-family: "Arial"; /* Font type */
  text-align: center;   /* alignment */
}

/* Setting Subtitle */
h3.subtitle {
  font-size: 24px;
  color: darkred;
}
/* Heading Level 1 (#) */
h1 {
  color: #003366;     /* Dark Blue */
  font-size: 28px;

}

/* Heading Level 2 (##) */
h2 {
  color: #2E8B57;     /* Sea Green */
  font-size: 22px;
  font-style: italic;
}

/* Heading Level 3 (###) */
h3 {
  color: #FF4500;     /* Orange Red */
  font-size: 18px;
}
```

> # **1. Introduction** 

*Bellabeat is a high-tech company that manufactures health-focused smart products.They offer different smart devices that collect data on activity, sleep, stress, and reproductive health to empower women with knowledge about their own health and habits.*

*The main focus of this case is to analyze smart devices fitness data and determine how it could help unlock new growth opportunities for Bellabeat. We will focus on one of Bellabeat’s products: Bellabeat app.*

*The Bellabeat app provides users with health data related to their activity, sleep, stress, menstrual cycle, and mindfulness habits. This data can help users better understand their current habits and make healthy decisions. The Bellabeat app connects to their line of smart wellness product.*

> # **2. Ask Phase**

## 2.1 Buiness task

Identify trends in how consumers use non-Bellabeat smart devices to apply insights into Bellabeat’s marketing strategy.

## 2.2 Stakeholders

- *UrškaSršen:* Bellabeat's co-founder and Chief Creative Officer.
- *Sando Mur:* Mathematician and Bellabeat's co-founder; key member of the Bellabeat executive team.
- *Bellabeat marketing analytics team:*  A team of data analysts responsible for collecting, analyzing, and repo ing
 data that helps guide Bellabeat’s marketing strategy.

## 2.3 Products 

- *Bellabeat app*:  The Bellabeat app provides users with health data related to their activity, sleep, stress,
 menstrual cycle, and mindfulness habits. This data can help user better understand their current habits and make healthy decisions. The Bellabeat app connects to their line of smart wellness products.
 
- *Bellabeat's classic wellness tracker*: can be worn as a wellness watch,bracelet, necklace, or clip. The wellness trackers connect to the Bellabeat app to track activity,sleep and stress to provide you with insights into your daily wellness.

> # **3. Prepare Phase**

## 3.1 Dataset used

The data source used for our case study is [FitBit Fitness Tracker Data](https://www.kaggle.com/datasets/arashnic/fitbit/code?datasetId=1041311&sortBy=voteCount). This data set is stored in Kaggle and was made available through Mobius.

## 3.2 Information about our dataset:
These data sets were generated by respondents to a distributed survey via Amazon Mechanical Turk between 03.12.2016-05.12.2016. Thirty eligible Fitbit users consented to the submission of personal tracker data, including minute-level output for physical activity, heart rate, and sleep monitoring. 

## 3.3 Data Credibility and Integrity

Due to the limitation of size (30 users) and not having any demographic information we could encounter a sampling bias. We are not sure if the sample is representative of the population as a whole. 

Another problem we would encounter is that dataset is not current and also the time limitation of the survey (2 months long). That is why we will give our case study an operational approach.

> # **4. Process Phase**

*I will focus my analysis in R due to the accessibility, amount of data and to be able to create data visualization to share my results with stakeholders.*

## 4.1 Installing packages and opening libraries

We will use the following packages for our analysis:

- tidyverse
- lubridate
- ggplot2
- skimr
- Janitor
- knitr
```{r}

library(tidyverse)
library(ggplot2)
library(lubridate)
library(skimr)
library(janitor)
library(knitr)
library(ggpubr)
```

## 4.2 Importing datasets

Knowing the data sets we have, we will upload the data sets that will help us answer our business task. On our analysis we will focus on the following data sets:

- `dailyActivity_merged` 
- `sleepDay_merged`
- `dailySteps_merged`

```{r}

daily_activity <- read.csv('C:/Case Study 2/Fitabase Data 4.12.16-5.12.16/dailyActivity_merged.csv')

daily_sleep <- read.csv('C:/Case Study 2/Fitabase Data 4.12.16-5.12.16/sleepDay_merged.csv')

daily_steps <- read.csv('C:/Case Study 2/Fitabase Data 4.12.16-5.12.16/dailySteps_merged.csv')

```

## 4.3 Preview our datasets

we will preview our selected data frames and check the summary of each column 

```{r}

head(daily_activity)
str(daily_activity)

head(daily_sleep)
str(daily_sleep)

head(daily_steps)
str(daily_steps)

```

## 4.4 Cleaning and formatting

Now that we got to know more about our data structures we will process them to look for any errors and inconsistencies.

### 4.4.1 Veryfying number of users

Before we continue with our cleaning we want to make sure how many unique users are per data frame. Even though 30 is the minimal sample size we will still keep the sleep data set for practice only.

```{r}

# Check user on daily_activity data frame
n_unique(daily_activity$Id)

# Check user on daily_sleep data frame
n_unique(daily_sleep$Id) 

# Check user on daily_steps data frame
n_unique(daily_steps$Id)

```
In the daily_sleep data frame, there maybe user who do not use a wellness tracker while sleeping.

### 4.4.2 Duplicates

We will now look for any duplicates:

```{r}

sum(duplicated(daily_activity))
sum(duplicated(daily_sleep))
sum(duplicated(daily_steps))

```

### 4.4.3 Remove duplicates and N/A

```{r}

daily_activity <- daily_activity %>%
  distinct() %>%
  drop_na()

daily_sleep <- daily_sleep %>%
  distinct() %>%
  drop_na()

daily_steps <- daily_steps %>%
  distinct() %>%
  drop_na()

```

```{r}
sum(duplicated(daily_sleep)) 
```

We will verify that duplicates have been removed.

### 4.4.4 Clean and rename columns

We want to ensure that column names are using right syntax and same format in all data sets since we will merge them later on. We are changing the format of all columns to lower case.

- First, we can check column names of all data sets

```{r, results = 'hide'}
# Changing format of all columns to lower case and create under scored in daily_activity data frames
daily_activity <- clean_names(daily_activity)


# Changing format of all columns to lower case and in daily_sleep data frames
daily_sleep <- clean_names(daily_sleep)

# Changing format of all columns to lower case and in daily_steps data frames
daily_steps <- clean_names(daily_steps)

```

### 4.4.5 Consistency of date and time columns

So, we will focus on cleaning date-time format for `daily_activity` and `daily_sleep` data frames since we will merge both data frames. Since We can disregard the time on `daily_sleep` data frame we are using `as-date` instead `as_datetime`.

```{r, results = 'hide'}

daily_activity <- daily_activity %>%
  rename(date = activity_date) %>%
  mutate(date = as_date(date,format = "%m/%d/%Y"))

daily_sleep <- daily_sleep %>%
  rename(date = sleep_day) %>%
  mutate(date = as_date(date,format = "%m/%d/%Y %I:%M:%S %p", tz = Sys.timezone()))

```

We will check our cleaned datasets.

```{r}

head(daily_activity)

head(daily_sleep)

```

## 4.5 Merging Datasets

We will merge `daily_activity` and `daily_sleep` to see any correlation between variables by using `id` and `date` as their primary keys.

```{r}

daily_activity_sleep <- merge(daily_activity, daily_sleep, by = c('id','date'))

glimpse(daily_activity_sleep)

```

> # **5. Analyze Phase and Share Phase**

## 5.1 Type of user per activity level

Since we don't have any demographic variables from our sample we want to determine the type of users with the data we have. We can classify the users by activity considering the daily amount of steps. We can categorize users as follows:

- Sedentary : Less than 5000 steps a day.
- Lightly active: Between 5000 and 7499 steps a day.
- Fairly active: Between 7500 and 9999 steps a day.
- Very active: More 10000 steps a day.

```{r}

daily_average_activity_users <- daily_activity_sleep %>%
  group_by(id) %>%
  summarise(Average_sleep_minutes = mean(total_minutes_asleep),
            Average_calorie_consumption = mean(calories),
            Average_steps = mean(total_steps),
            )

head(daily_average_activity_users)

```


- Type of user per activity level

```{r}

user_types <- daily_average_activity_users %>%
  mutate(user_types = case_when(
                              Average_steps < 5000 ~ "Sedentary",
                              Average_steps >= 5000 & Average_steps <= 7499 ~ "Lightly active",
                              Average_steps >= 7500 & Average_steps <= 9999 ~ "Fairly active",
                              Average_steps >= 10000 ~ "Very active"))
head(user_types)
```

```{r}

user_types_percent <- user_types %>%
  group_by(user_types) %>%
  summarise(total = n()) %>%
  mutate(totals = sum(total)) %>% 
  group_by(user_types) %>%
  summarise(total_percent = total / totals) %>%
  mutate(label = scales::percent(total_percent))
head(user_types_percent)

```

Now, we have a new column with the user types we will create a data frame with the percentage of each user types to better visualize them on a graph.

- First, we need to arrange the `user_types` in order.

```{r}

user_types_percent$user_types = factor(user_types_percent$user_types, levels = c("Sedentary", "Lightly active", "Fairly active", "Very active"))

```

```{r}

user_types_percent  %>%
  ggplot(mapping = aes(x = "" ,y = total_percent, fill = user_types)) + 
  geom_col(width = 1, color = "white") +
  coord_polar(theta = "y") +
  geom_text(aes(label = label), position = position_stack(vjust = 0.5)) +
  theme_void() + 
  ggtitle("User Types Percent")

```

 *We can see that user types are evenly distributed according to their activity based on daily step counts. We can determine all types of users regularly use smart devices to track their daily activity, based on user activity.*

```{r}

user_types %>%
  ggplot(aes(x = Average_sleep_minutes, y = Average_steps,colours = user_types)) + geom_point(alpha = 0.3, position = position_jitter()) + facet_wrap(~ user_types) + labs(title = "Correlation Between Average Sleep Minutes and Steps", subtitle = "Comparison between Activity Levels")

```
 
 *At different levels of user activity, higher-activity user groups (`Fairly active` and `Very active`) show significantly higher daily step counts, while sleep duration does not show a clear relationship with step counts between user groups.However, the dataset contains relatively few users.*
 
 - Next, we want to know exactly now what days of the week are the users more active and also what days of the week users sleep more.

## 5.2 Steps and minutes asleep per weekday

We will check whether users meet the recommended step and sleep time thresholds. 

- Create a weekday variable from the date column and calculate the average number of steps and minutes of a sleep for each day of week 

```{r}

daily_activity_sleep_of_week <- daily_activity_sleep %>%
  mutate(type = case_when(total_steps < 5000 ~ "Sedantary",
                                total_steps >= 5000 & total_steps <= 7499 ~ "Lightly active",
                                total_steps >= 7500 & total_steps <= 9999 ~ "Fairyly active",
                              total_steps >= 10000  ~ "Very active"),
    day_of_week = factor(weekdays(date),levels = c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"),ordered = T)) 

```

```{r}
table(daily_activity_sleep_of_week$type)

table(daily_activity_sleep_of_week$day_of_week)
```

- Summarize and calculating the average steps and minutes sleeps.

```{r}

Average_activity_of_week <- daily_activity_sleep_of_week %>%
  group_by(day_of_week) %>%
  summarise(avg_daily_steps = mean(total_steps),
            avg_daily_sleep = mean(total_minutes_asleep))

head(Average_activity_of_week)

```
So we will visually go through the activities (Minutes sleep and steps daily) of these users over a week. 

- [How Much Sleep Do You Really Need?](https://www.thensf.org/how-many-hours-of-sleep-do-you-really-need/) : "Between the ages of 18 and 64, adults should aim for **seven to nine hours** of nightly sleep".

- [How many steps/day are enough? for adults](https://pubmed.ncbi.nlm.nih.gov/21798015/): "A direct estimate of minimal amounts of MVPA accumulated in the course of objectively monitored free-living behaviour is **7,000-8,000** steps/day".

```{r}

ggarrange(
  ggplot(Average_activity_of_week) + geom_col(mapping = aes(x = day_of_week, y = avg_daily_sleep,fill = day_of_week)) + geom_hline(yintercept = 420) + labs(title = "Minutes asleep on a week", x = " ", y = " ") + theme(axis.text.x = element_text(angle = 90)),
  
  ggplot(Average_activity_of_week) + geom_col(mapping = aes(x = day_of_week, y = avg_daily_steps,fill = day_of_week)) + geom_hline(yintercept = 7500) + labs(title = "Daily steps on a week", x = " ", y = " ") + theme(axis.text.x = element_text(angle = 90))
)
```

In the graphs above we can determine the following:

- User have sleep close the recommended amount of minutes/hours - 7 to 9 hours.

- Users walk daily the recommended amount of steps of 7500 except Sunday. 

- On Saturdays, they don't go to work, users' daily steps are the highest, during activities like walking outdoors. So on Sundays, they spend time resting and sleeping to prepare for the new work week.

## 5.3 Correlation

In the chart **`"Correlation Between Average Sleep Minutes and Steps Activity Levels"`** we can see that there is no relationship in sleep habits between people who are less active and those who are more active. Therefore, to gain a clearer view, we will proceed to build a more big-picture.

We will now determine if there is any correlation between different variables:

- Daily steps and daily sleep.
 
- Daily steps and calories.

```{r}

ggarrange( 
    ggplot(daily_activity_sleep,aes(x = total_steps, y = total_minutes_asleep)) + geom_point() + geom_smooth(color = "red") + labs(title = "Daily Steps And Daily Asleep"),
    ggplot(daily_activity_sleep,aes(x = total_steps, y = calories)) + geom_point() + geom_smooth(color = "blue") + labs(title = "Daily Steps And Calories Consumed")
)

```
**Comments:**

- In the Paragraph 1 `Daily Steps And Daily Asleep`, there is no *correlation* between daily activity based on the number of steps and the number of minutes a user sleeps each day. 

- On the contrary, we can see a positive correlation between the number of steps and calories consume. We can conclude that taking more steps help consumed more calories.

> # 6. Conclusion( Act Phase )

Datasets used have a small sample and can be biased since we didn't have any demographic details of users. Knowing that our main target are young and adult women I would encourage to continue finding trends to be able to create a marketing focused on them.

**Recommendations**

*The objective Bellabeat is to empower women by providing them with the data to discover themselves. Based on minute-by-minute data on steps activity, calories, and sleep , we propose the following strategies:*

**Strategy A:** *"Wellness that blends into your life"* .

**Proposal: ** We will divide the regime into four types of users based on their daily physical activity, from which suitable strategies for each individual will be provided, and notify them daily with a single note about Everyday Movement Lifestyle (Key Marketing Messages).

 1. Ease Mode/ Gentle Rhythm ( < 5,000 steps): We focus on promoting long-term wellness by encouraging gentle daily movement, offering mindful activity reminders, and integrating calming meditation and relaxation features. The messaging stays warm and supportive, avoiding any high-intensity fitness wording.
 
 2. Daily Flow / Active Ease ( Between >= 5000 and <= 7499 steps ): Enhance their daily habits with small, achievable goals and cleverly designed challenges, making it easier to meet scientifically recommended steps and providing added motivation.
  
 3. Balanced Motion / Everyday Energy ( Between >= 7500 and <= 9999 steps ): 
Provide daily reminders and set goals so they can achieve the 10,000-steps.

 4. Peak Vitality / Dynamic Performance ( > 10000 steps):
 Create additional programs and metrics to help them monitor indicators (Recovery Metrics, General Wellness Metrics, Stress level, ...)

**Rationale: ** Activity segmentation allows us to deliver tailored goals, reminders, and insights. Users engage longer with personalized guidance, which directly improves retention and daily active usage.

**Strategy B:** *"Train smarter by listening to your night."*.

**Proposal:  ** Our sleep-adjusted workout recommendation analyzes sleep duration, sleep quality, and recovery metrics (HRV, resting heart rate) to determine your body’s readiness for physical load and for training and daily walking routines.

**Rationale: ** When sleep and training work together, your performance improves naturally: 

 - More progress
 
 - Fewer injuries 
 
 - A healthier rhythm for your everyday life,...
 
=> The most attractive thing is the feeling of being understood + being supported + living healthily with ease.
